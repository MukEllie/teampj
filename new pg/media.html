<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¯¸ë””ì–´ - ê²Œì„ í¬í„¸</title>
    <link rel="stylesheet" href="styles.css">
    <script src="common-auth.js"></script>
</head>
<body>
    <!-- í—¤ë” ë„¤ë¹„ê²Œì´ì…˜ -->
    <header class="header">
        <div class="nav-container">
            <a href="index.html" class="logo">
                <span class="logo-icon">ğŸ®</span>
                <span class="logo-text">GAME PORTAL</span>
            </a>
            
            <nav class="nav">
                <ul class="nav-menu" id="navMenu">
                    <li class="nav-item">
                        <a href="game.html" class="nav-link">ê²Œì„</a>
                    </li>
                    <li class="nav-item">
                        <a href="game-info.html" class="nav-link">ê²Œì„ì •ë³´</a>
                    </li>
                    <li class="nav-item">
                        <a href="news.html" class="nav-link">ê³µì§€ì‚¬í•­</a>
                    </li>
                    <li class="nav-item">
                        <a href="gacha-shop.html" class="nav-link">ê°€ì± ìƒµ</a>
                    </li>
                    <li class="nav-item">
                        <a href="community.html" class="nav-link">ì»¤ë®¤ë‹ˆí‹°</a>
                    </li>
                    <li class="nav-item">
                        <a href="media.html" class="nav-link">ë¯¸ë””ì–´</a>
                    </li>
                    <li class="nav-item">
                        <a href="customer-service.html" class="nav-link">ê³ ê°ì„¼í„°</a>
                    </li>
                </ul>
            </nav>

            <div class="auth-buttons">
                <a href="#" class="auth-btn login-btn" id="loginBtn">ë¡œê·¸ì¸</a>
                <a href="#" class="auth-btn signup-btn" id="signupBtn">íšŒì›ê°€ì…</a>
            </div>

            <button class="mobile-menu-toggle" id="mobileToggle">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </header>

    <!-- ë©”ì¸ ì»¨í…ì¸  -->
    <main class="main">
        <!-- í˜ì´ì§€ í—¤ë” -->
        <section class="page-header media-header gradient-media">
            <div class="container">
                <div class="page-header-content">
                    <h1 class="page-title">ğŸ¬ ë¯¸ë””ì–´</h1>
                    <p class="page-subtitle">ê²Œì„ì˜ ì•„ë¦„ë‹¤ìš´ ìˆœê°„ë“¤ì„ ê°ìƒí•˜ì„¸ìš”</p>
                </div>
            </div>
        </section>

        <!-- ë¯¸ë””ì–´ ì»¨í…ì¸  -->
        <section class="content-section">
            <div class="container">
                <!-- ë¯¸ë””ì–´ ì•¡ì…˜ ë°” -->
                <div class="media-action-bar" style="
                    background: white; 
                    padding: 1.5rem; 
                    border-radius: 15px; 
                    margin-bottom: 2rem; 
                    box-shadow: 0 5px 20px rgba(0,0,0,0.1);
                    display: flex; 
                    justify-content: space-between; 
                    align-items: center; 
                    flex-wrap: wrap; 
                    gap: 1rem;
                ">
                    <div class="action-buttons" style="display: flex; gap: 1rem; flex-wrap: wrap;">
                        <button class="btn btn-primary" onclick="window.mediaManager && window.mediaManager.showUploadModal()" style="
                            background: linear-gradient(45deg, #667eea, #764ba2); 
                            color: white; 
                            border: none; 
                            padding: 0.8rem 1.5rem; 
                            border-radius: 8px; 
                            cursor: pointer; 
                            font-weight: 600;
                            transition: all 0.3s ease;
                        ">
                            ğŸ“¤ ë¯¸ë””ì–´ ì—…ë¡œë“œ
                        </button>
                        <button class="btn btn-secondary" onclick="window.mediaManager && window.mediaManager.showMyMedia()" style="
                            background: #6c757d; 
                            color: white; 
                            border: none; 
                            padding: 0.8rem 1.5rem; 
                            border-radius: 8px; 
                            cursor: pointer; 
                            font-weight: 600;
                            transition: all 0.3s ease;
                        ">
                            ğŸ“ ë‚´ ë¯¸ë””ì–´
                        </button>
                        <button class="btn btn-warning" onclick="window.mediaManager && window.mediaManager.showAdvancedSearch()" style="
                            background: #ffc107; 
                            color: #333; 
                            border: none; 
                            padding: 0.8rem 1.5rem; 
                            border-radius: 8px; 
                            cursor: pointer; 
                            font-weight: 600;
                            transition: all 0.3s ease;
                        ">
                            ğŸ” ê³ ê¸‰ ê²€ìƒ‰
                        </button>
                        <button class="btn btn-info" onclick="window.mediaManager && window.mediaManager.showMediaStats()" style="
                            background: #17a2b8; 
                            color: white; 
                            border: none; 
                            padding: 0.8rem 1.5rem; 
                            border-radius: 8px; 
                            cursor: pointer; 
                            font-weight: 600;
                            transition: all 0.3s ease;
                        ">
                            ğŸ“Š ë¯¸ë””ì–´ í†µê³„
                        </button>
                    </div>
                    <div class="view-options" style="display: flex; gap: 1rem; align-items: center;">
                        <label style="color: #666; font-weight: 600;">ë³´ê¸°:</label>
                        <select id="viewModeSelect" style="padding: 0.5rem; border: 1px solid #ddd; border-radius: 5px;">
                            <option value="grid">ê²©ì ë³´ê¸°</option>
                            <option value="list">ë¦¬ìŠ¤íŠ¸ ë³´ê¸°</option>
                        </select>
                    </div>
                </div>

                <!-- ë¯¸ë””ì–´ íƒ­ -->
                <div class="media-tabs">
                    <button class="media-tab active" data-tab="screenshots">ìŠ¤í¬ë¦°ìƒ·</button>
                    <button class="media-tab" data-tab="videos">ë™ì˜ìƒ</button>
                    <button class="media-tab" data-tab="artwork">ì•„íŠ¸ì›Œí¬</button>
                    <button class="media-tab" data-tab="wallpapers">ë°°ê²½í™”ë©´</button>
                </div>

                <!-- ìŠ¤í¬ë¦°ìƒ· ì„¹ì…˜ -->
                <div class="media-section active" id="screenshots">
                    <h3>ğŸ“¸ ê²Œì„ ìŠ¤í¬ë¦°ìƒ·</h3>
                    <div class="media-gallery">
                        <div class="loading-placeholder" style="grid-column: 1/-1; text-align: center; padding: 3rem; color: #666;">
                            <div class="loading-spinner" style="margin: 0 auto 1rem auto;"></div>
                            <p>ë¯¸ë””ì–´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
                        </div>
                    </div>
                </div>

                <!-- ë™ì˜ìƒ ì„¹ì…˜ -->
                <div class="media-section" id="videos">
                    <h3>ğŸ¥ ê²Œì„ ë™ì˜ìƒ</h3>
                    <div class="media-gallery">
                        <!-- ë™ì ìœ¼ë¡œ ë¡œë“œë¨ -->
                    </div>
                </div>

                <!-- ì•„íŠ¸ì›Œí¬ ì„¹ì…˜ -->
                <div class="media-section" id="artwork">
                    <h3>ğŸ¨ ì»¨ì…‰ ì•„íŠ¸ì›Œí¬</h3>
                    <div class="media-gallery">
                        <!-- ë™ì ìœ¼ë¡œ ë¡œë“œë¨ -->
                    </div>
                </div>

                <!-- ë°°ê²½í™”ë©´ ì„¹ì…˜ -->
                <div class="media-section" id="wallpapers">
                    <h3>ğŸ–¥ï¸ ê³µì‹ ë°°ê²½í™”ë©´</h3>
                    <div class="media-gallery">
                        <!-- ë™ì ìœ¼ë¡œ ë¡œë“œë¨ -->
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- í‘¸í„° -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>ê²Œì„ í¬í„¸</h4>
                    <p>ìµœê³ ì˜ ê²Œì„ ê²½í—˜ì„ ì œê³µí•©ë‹ˆë‹¤</p>
                </div>
                <div class="footer-section">
                    <h4>ì§€ì›</h4>
                    <a href="#">FAQ</a>
                    <a href="customer-service.html">ê³ ê°ì„¼í„°</a>
                    <a href="#">ë²„ê·¸ ì‹ ê³ </a>
                </div>
                <div class="footer-section">
                    <h4>ì»¤ë®¤ë‹ˆí‹°</h4>
                    <a href="community.html">ê³µì‹ í¬ëŸ¼</a>
                    <a href="#">ë””ìŠ¤ì½”ë“œ</a>
                    <a href="#">ìœ íŠœë¸Œ</a>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Game Portal. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- JavaScript íŒŒì¼ë“¤ -->
    <script src="media.js"></script>
    <script>
        // ë ˆê±°ì‹œ ë¸Œë¼ìš°ì € ì§€ì›ì„ ìœ„í•œ í´ë¦¬í•„
        if (!Element.prototype.matches) {
            Element.prototype.matches = Element.prototype.msMatchesSelector || Element.prototype.webkitMatchesSelector;
        }

        if (!Element.prototype.closest) {
            Element.prototype.closest = function(s) {
                var el = this;
                do {
                    if (Element.prototype.matches.call(el, s)) return el;
                    el = el.parentElement || el.parentNode;
                } while (el !== null && el.nodeType === 1);
                return null;
            };
        }

        // ì•ˆì „í•œ ë¯¸ë””ì–´ URL ìƒì„± í•¨ìˆ˜
        function getSecureMediaUrl(mediaItem) {
            if (!mediaItem) return null;
            
            // ì™¸ë¶€ í”Œë«í¼
            if (mediaItem.mime_type === 'video/youtube' || mediaItem.mime_type === 'video/vimeo') {
                return mediaItem.file_url || mediaItem.file_path;
            }
            
            // ì™¸ë¶€ URL
            if (mediaItem.file_url && (mediaItem.file_url.startsWith('http://') || mediaItem.file_url.startsWith('https://'))) {
                return mediaItem.file_url;
            }
            
            // ë¡œì»¬ íŒŒì¼
            if (mediaItem.file_name) {
                return `/uploads/media/${mediaItem.file_name}`;
            }
            
            return null;
        }

        // YouTube ID ì¶”ì¶œ í•¨ìˆ˜
        function extractYouTubeId(url) {
            if (!url) return null;
            
            const patterns = [
                /(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/i,
                /youtube\.com\/embed\/([^"&?\/\s]{11})/i
            ];
            
            for (const pattern of patterns) {
                const match = url.match(pattern);
                if (match) return match[1];
            }
            
            return null;
        }

        // ì¹´í…Œê³ ë¦¬ ì•„ì´ì½˜ í•¨ìˆ˜
        function getCategoryIcon(categoryCode) {
            const icons = {
                'screenshots': 'ğŸ“¸',
                'videos': 'ğŸ¥',
                'artwork': 'ğŸ¨',
                'wallpapers': 'ğŸ–¥ï¸'
            };
            return icons[categoryCode] || 'ğŸ“';
        }

        // ê°œì„ ëœ ë¯¸ë””ì–´ í‘œì‹œ í•¨ìˆ˜
        function displayMedia(mediaItem) {
            if (!mediaItem) return '<div>ë¯¸ë””ì–´ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤</div>';
            
            const isYouTube = mediaItem.mime_type === 'video/youtube' || 
                             (mediaItem.file_url && mediaItem.file_url.includes('youtube.com/embed')) ||
                             (mediaItem.file_path && (mediaItem.file_path.includes('youtube.com') || mediaItem.file_path.includes('youtu.be')));
            
            const isVimeo = mediaItem.mime_type === 'video/vimeo' || 
                           (mediaItem.file_url && mediaItem.file_url.includes('player.vimeo.com'));
            
            if (isYouTube) {
                const youtubeId = extractYouTubeId(mediaItem.file_path || mediaItem.file_url);
                const thumbnailUrl = youtubeId ? `https://img.youtube.com/vi/${youtubeId}/maxresdefault.jpg` : null;
                
                return `
                    <div class="video-container youtube-preview" style="position: relative; width: 100%; height: 200px; border-radius: 10px; overflow: hidden; background: #000; cursor: pointer;">
                        ${thumbnailUrl ? `
                            <img src="${thumbnailUrl}" alt="${mediaItem.title}" 
                                 style="width: 100%; height: 100%; object-fit: cover;"
                                 onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                        ` : ''}
                        <div class="youtube-placeholder" style="${thumbnailUrl ? 'display: none;' : 'display: flex;'} position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(135deg, #ff0000, #cc0000); align-items: center; justify-content: center; flex-direction: column; color: white;">
                            <span style="font-size: 2.5rem; margin-bottom: 0.5rem;">ğŸ“º</span>
                            <span style="font-weight: 600; font-size: 0.9rem;">YouTube</span>
                        </div>
                        <div class="play-indicator" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); opacity: 0.9; pointer-events: none;">
                            <div style="background: rgba(255,0,0,0.9); color: white; border-radius: 6px; padding: 0.4rem 0.8rem; font-size: 0.8rem; font-weight: 600; display: flex; align-items: center; gap: 0.3rem;">
                                <span>â–¶ï¸</span>
                                <span>YouTube</span>
                            </div>
                        </div>
                    </div>
                `;
            } else if (isVimeo) {
                return `
                    <div class="video-container vimeo-preview" style="position: relative; width: 100%; height: 200px; border-radius: 10px; overflow: hidden;">
                        <div style="width: 100%; height: 100%; background: linear-gradient(135deg, #1ab7ea, #1563c7); display: flex; align-items: center; justify-content: center; flex-direction: column; color: white;">
                            <span style="font-size: 2.5rem; margin-bottom: 0.5rem;">ğŸ¬</span>
                            <span style="font-weight: 600; font-size: 0.9rem;">Vimeo</span>
                        </div>
                        <div class="play-indicator" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); opacity: 0.9;">
                            <div style="background: rgba(26,183,234,0.9); color: white; border-radius: 6px; padding: 0.4rem 0.8rem; font-size: 0.8rem; font-weight: 600; display: flex; align-items: center; gap: 0.3rem;">
                                <span>â–¶ï¸</span>
                                <span>Vimeo</span>
                            </div>
                        </div>
                    </div>
                `;
            } else if (mediaItem.file_type === 'video') {
                const videoUrl = getSecureMediaUrl(mediaItem);
                return `
                    <div class="video-container" style="position: relative; height: 200px; border-radius: 10px; overflow: hidden;">
                        ${videoUrl ? `
                            <video style="width: 100%; height: 100%; object-fit: cover; border-radius: 10px;" preload="metadata" muted>
                                <source src="${videoUrl}" type="${mediaItem.mime_type || 'video/mp4'}">
                            </video>
                        ` : `
                            <div style="width: 100%; height: 100%; background: linear-gradient(135deg, #667eea, #764ba2); display: flex; align-items: center; justify-content: center; flex-direction: column; color: white;">
                                <span style="font-size: 2.5rem; margin-bottom: 0.5rem;">ğŸ¥</span>
                                <span style="font-weight: 600; font-size: 0.9rem;">ë™ì˜ìƒ</span>
                            </div>
                        `}
                        <div class="play-indicator" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); opacity: 0; transition: opacity 0.3s ease;">
                            <div style="background: rgba(0,0,0,0.8); color: white; border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center;">
                                <span>â–¶</span>
                            </div>
                        </div>
                    </div>
                `;
            } else {
                const imageUrl = getSecureMediaUrl(mediaItem);
                return `
                    <div class="media-thumbnail" style="height: 200px; overflow: hidden; border-radius: 10px; background: #f8f9fa;">
                        ${imageUrl && !mediaItem.is_placeholder ? `
                            <img src="${imageUrl}" alt="${mediaItem.title}" 
                                 style="width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s ease;"
                                 loading="lazy"
                                 onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                        ` : ''}
                        <div class="image-placeholder" style="${imageUrl && !mediaItem.is_placeholder ? 'display: none;' : 'display: flex;'} width: 100%; height: 100%; background: linear-gradient(135deg, #f8f9fa, #e9ecef); align-items: center; justify-content: center; flex-direction: column; color: #666;">
                            <span style="font-size: 2.5rem; margin-bottom: 0.5rem;">${getCategoryIcon(mediaItem.category_code)}</span>
                            <span style="font-weight: 600; text-align: center; padding: 0 1rem; font-size: 0.8rem;">${mediaItem.title}</span>
                            <span style="font-size: 0.7rem; margin-top: 0.3rem; opacity: 0.7;">ì´ë¯¸ì§€ ì—†ìŒ</span>
                        </div>
                    </div>
                `;
            }
        }

        // ë¯¸ë””ì–´ ì•„ì´í…œ HTML ìƒì„± í•¨ìˆ˜
        function createMediaItemHTML(item) {
            const mediaContent = displayMedia(item);
            const isVideo = item.file_type === 'video';
            const isYouTube = item.mime_type === 'video/youtube' || (item.file_url && item.file_url.includes('youtube.com/embed'));
            const isVimeo = item.mime_type === 'video/vimeo' || (item.file_url && item.file_url.includes('player.vimeo.com'));
            
            return `
                <div class="media-item" data-id="${item.media_id}" onclick="openMediaModal(${item.media_id})">
                    ${mediaContent}
                    
                    <div class="media-info">
                        <h4 class="media-title">${item.title}</h4>
                        <p class="media-description">${item.description || ''}</p>
                        <div class="media-meta">
                            <span>ğŸ“… ${new Date(item.upload_date || item.created_at).toLocaleDateString('ko-KR')}</span>
                            <span>ğŸ“‚ ${item.category_name}</span>
                        </div>
                        <div class="media-stats">
                            <span>ğŸ‘ï¸ ${item.views || 0}</span>
                            <span>â¤ï¸ ${item.likes || 0}</span>
                            <span>â¬‡ï¸ ${item.downloads || 0}</span>
                            ${item.tags && item.tags.length > 0 ? `<span>ğŸ·ï¸ ${item.tags.slice(0, 2).join(', ')}</span>` : ''}
                        </div>
                    </div>
                </div>
            `;
        }

        // ë¯¸ë””ì–´ ì•„ì´í…œ ëª©ë¡ ì¡°íšŒ
        async function loadMediaItems(category = 'screenshots') {
            try {
                console.log(`ë¯¸ë””ì–´ ë¡œë“œ ì‹œì‘ - ì¹´í…Œê³ ë¦¬: ${category}`);
                
                const response = await fetch(`/api/media/items?category=${category}&limit=50`);
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const items = await response.json();
                console.log(`ë¯¸ë””ì–´ ì•„ì´í…œ ì¡°íšŒ ì„±ê³µ: ${items.length}ê°œ`);
                
                const galleryElement = document.querySelector(`#${category} .media-gallery`);
                if (!galleryElement) {
                    console.error(`ê°¤ëŸ¬ë¦¬ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ: #${category} .media-gallery`);
                    return;
                }

                if (items.length === 0) {
                    galleryElement.innerHTML = `
                        <div class="no-media" style="grid-column: 1/-1; text-align: center; padding: 3rem; color: #666;">
                            <div style="font-size: 3rem; margin-bottom: 1rem;">${getCategoryIcon(category)}</div>
                            <p>ì•„ì§ ì—…ë¡œë“œëœ ë¯¸ë””ì–´ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
                        </div>
                    `;
                    return;
                }

                const itemsHTML = items.map(item => createMediaItemHTML(item)).join('');
                galleryElement.innerHTML = itemsHTML;
                console.log(`${category} ê°¤ëŸ¬ë¦¬ ì—…ë°ì´íŠ¸ ì™„ë£Œ: ${items.length}ê°œ ì•„ì´í…œ`);
                
            } catch (error) {
                console.error('ë¯¸ë””ì–´ ë¡œë“œ ì‹¤íŒ¨:', error);
                const galleryElement = document.querySelector(`#${category} .media-gallery`);
                if (galleryElement) {
                    galleryElement.innerHTML = `
                        <div class="error-message" style="grid-column: 1/-1; text-align: center; padding: 3rem; color: #ff6b6b;">
                            <div style="font-size: 3rem; margin-bottom: 1rem;">âš ï¸</div>
                            <p>ë¯¸ë””ì–´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>
                            <button onclick="loadMediaItems('${category}')" style="margin-top: 1rem; padding: 0.5rem 1rem; background: #667eea; color: white; border: none; border-radius: 5px; cursor: pointer;">ë‹¤ì‹œ ì‹œë„</button>
                        </div>
                    `;
                }
            }
        }

        // í˜ì´ì§€ ì´ˆê¸°í™” í•¨ìˆ˜
        function initializeMediaPage() {
            console.log('ë¯¸ë””ì–´ í˜ì´ì§€ ì´ˆê¸°í™” ì‹œì‘');
            
            // íƒ­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            document.querySelectorAll('.media-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const category = this.dataset.tab;
                    
                    // ëª¨ë“  íƒ­ê³¼ ì„¹ì…˜ì—ì„œ active í´ë˜ìŠ¤ ì œê±°
                    document.querySelectorAll('.media-tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.media-section').forEach(s => s.classList.remove('active'));
                    
                    // ì„ íƒëœ íƒ­ê³¼ ì„¹ì…˜ì— active í´ë˜ìŠ¤ ì¶”ê°€
                    this.classList.add('active');
                    const targetSection = document.getElementById(category);
                    if (targetSection) {
                        targetSection.classList.add('active');
                    }
                    
                    // í•´ë‹¹ ì¹´í…Œê³ ë¦¬ ë¯¸ë””ì–´ ë¡œë“œ
                    loadMediaItems(category);
                });
            });
            
            // ì´ˆê¸° ë¯¸ë””ì–´ ë¡œë“œ (ìŠ¤í¬ë¦°ìƒ·)
            loadMediaItems('screenshots');
        }

        // ë¯¸ë””ì–´ ëª¨ë‹¬ ì—´ê¸° í•¨ìˆ˜
        async function openMediaModal(mediaId) {
            try {
                console.log('ë¯¸ë””ì–´ ìƒì„¸ ë³´ê¸°:', mediaId);
                
                const response = await fetch(`/api/media/items/${mediaId}`);
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ë¯¸ë””ì–´ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤`);
                }
                
                const data = await response.json();
                showMediaDetailModal(data);
            } catch (error) {
                console.error('ë¯¸ë””ì–´ ìƒì„¸ ì •ë³´ ë¡œë“œ ì‹¤íŒ¨:', error);
                showErrorModal('ë¯¸ë””ì–´ ìƒì„¸ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // ë¯¸ë””ì–´ ìƒì„¸ ëª¨ë‹¬ í‘œì‹œ í•¨ìˆ˜
        function showMediaDetailModal(mediaItem) {
            if (!mediaItem) {
                showErrorModal('ë¯¸ë””ì–´ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            // ê¸°ì¡´ ëª¨ë‹¬ì´ ìˆìœ¼ë©´ ì œê±°
            const existingModal = document.getElementById('mediaDetailModal');
            if (existingModal) {
                existingModal.remove();
            }

            const isVideo = mediaItem.file_type === 'video';
            const isYouTube = mediaItem.mime_type === 'video/youtube' || 
                             (mediaItem.file_url && mediaItem.file_url.includes('youtube.com/embed'));
            const isVimeo = mediaItem.mime_type === 'video/vimeo' || 
                           (mediaItem.file_url && mediaItem.file_url.includes('player.vimeo.com'));
            
            const youtubeId = isYouTube ? extractYouTubeId(mediaItem.file_path || mediaItem.file_url) : null;
            const thumbnailUrl = youtubeId ? `https://img.youtube.com/vi/${youtubeId}/maxresdefault.jpg` : getSecureMediaUrl(mediaItem);

            // ëª¨ë‹¬ HTML ìƒì„±
            const modalHTML = `
                <div id="mediaDetailModal" class="modal-overlay" style="
                    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                    background: rgba(0,0,0,0.8); display: flex; justify-content: center; align-items: center;
                    z-index: 1000; animation: fadeIn 0.3s ease;
                " onclick="closeMediaModal(event)">
                    <div class="modal-content" style="
                        background: white; border-radius: 15px; max-width: 90vw; max-height: 90vh;
                        overflow-y: auto; position: relative; animation: slideUp 0.3s ease;
                        width: 100%; max-width: 1000px;
                    " onclick="event.stopPropagation()">
                        <button class="modal-close" onclick="closeMediaModal()" style="
                            position: absolute; top: 15px; right: 20px; background: none; border: none;
                            font-size: 24px; cursor: pointer; z-index: 1001; color: #999;
                            padding: 0.5rem; border-radius: 50%; transition: all 0.3s ease;
                        ">Ã—</button>
                        
                        <div style="padding: 2rem;">
                            <div id="modalMediaContent" style="margin-bottom: 1.5rem; text-align: center;">
                                ${createModalMediaContent(mediaItem, isYouTube, isVimeo, isVideo, thumbnailUrl, youtubeId)}
                            </div>
                            
                            <div class="media-detail-info">
                                <h2 style="margin: 0 0 1rem 0; color: #333;">${mediaItem.title}</h2>
                                <p style="color: #666; line-height: 1.6; margin-bottom: 1rem;">${mediaItem.description || ''}</p>
                                
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 1rem; background: #f8f9fa; padding: 1rem; border-radius: 8px;">
                                    <div><strong>ì—…ë¡œë“œ:</strong> ${new Date(mediaItem.upload_date || mediaItem.created_at).toLocaleDateString('ko-KR')}</div>
                                    <div><strong>ì¹´í…Œê³ ë¦¬:</strong> ${mediaItem.category_name}</div>
                                    <div><strong>íƒ€ì…:</strong> ${isYouTube ? 'YouTube' : isVimeo ? 'Vimeo' : mediaItem.file_type}</div>
                                    <div><strong>ì¡°íšŒìˆ˜:</strong> ${(mediaItem.views || 0).toLocaleString()}</div>
                                    <div><strong>ì¢‹ì•„ìš”:</strong> ${(mediaItem.likes || 0).toLocaleString()}</div>
                                    <div><strong>ë‹¤ìš´ë¡œë“œ:</strong> ${(mediaItem.downloads || 0).toLocaleString()}</div>
                                </div>
                                
                                ${mediaItem.tags && mediaItem.tags.length > 0 ? `
                                    <div style="margin-bottom: 1.5rem;">
                                        <strong style="color: #333;">íƒœê·¸:</strong>
                                        <div style="margin-top: 0.5rem;">
                                            ${mediaItem.tags.map(tag => `<span style="background: #e9ecef; color: #495057; padding: 0.3rem 0.8rem; border-radius: 15px; font-size: 0.8rem; margin-right: 0.5rem; display: inline-block; margin-bottom: 0.5rem;">${tag}</span>`).join('')}
                                        </div>
                                    </div>
                                ` : ''}
                                
                                <div style="display: flex; gap: 1rem; flex-wrap: wrap; justify-content: center;">
                                    <button onclick="likeMedia(${mediaItem.media_id})" style="
                                        background: #ff6b6b; color: white; border: none; padding: 0.8rem 1.5rem;
                                        border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s ease;
                                    ">â¤ï¸ ì¢‹ì•„ìš”</button>
                                    
                                    ${!isYouTube && !isVimeo ? `
                                        <button onclick="downloadMedia(${mediaItem.media_id})" style="
                                            background: #4ecdc4; color: white; border: none; padding: 0.8rem 1.5rem;
                                            border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s ease;
                                        ">â¬‡ï¸ ë‹¤ìš´ë¡œë“œ</button>
                                    ` : `
                                        <button onclick="openOriginalVideo('${mediaItem.file_path || mediaItem.file_url || ''}')" style="
                                            background: #667eea; color: white; border: none; padding: 0.8rem 1.5rem;
                                            border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s ease;
                                        ">ğŸ”— ì›ë³¸ ë³´ê¸°</button>
                                    `}
                                    
                                    <button onclick="shareMedia(${mediaItem.media_id})" style="
                                        background: #6c757d; color: white; border: none; padding: 0.8rem 1.5rem;
                                        border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s ease;
                                    ">ğŸ“¤ ê³µìœ </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // ëª¨ë‹¬ì„ bodyì— ì¶”ê°€
            document.body.insertAdjacentHTML('beforeend', modalHTML);
            
            // ëª¨ë‹¬ í‘œì‹œ ì• ë‹ˆë©”ì´ì…˜
            const modal = document.getElementById('mediaDetailModal');
            modal.style.opacity = '0';
            setTimeout(() => {
                modal.style.opacity = '1';
                modal.style.transition = 'opacity 0.3s ease';
            }, 10);
        }

        // ëª¨ë‹¬ìš© ë¯¸ë””ì–´ ì½˜í…ì¸  ìƒì„±
        function createModalMediaContent(mediaItem, isYouTube, isVimeo, isVideo, thumbnailUrl, youtubeId) {
            if (isYouTube) {
                return `
                    <div id="youtubeContainer" style="position: relative; width: 100%; max-width: 800px; height: 450px; margin: 0 auto; border-radius: 8px; overflow: hidden; background: #000;">
                        ${thumbnailUrl ? `
                            <div class="youtube-thumbnail-wrapper" style="width: 100%; height: 100%; position: relative; cursor: pointer;" onclick="replaceWithYouTubePlayer('${mediaItem.file_url}', '${youtubeId}')">
                                <img src="${thumbnailUrl}" alt="${mediaItem.title}" 
                                     style="width: 100%; height: 100%; object-fit: cover;"
                                     onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                <div class="youtube-error" style="display: none; width: 100%; height: 100%; background: linear-gradient(135deg, #ff0000, #cc0000); align-items: center; justify-content: center; flex-direction: column; color: white;">
                                    <span style="font-size: 4rem; margin-bottom: 1rem;">ğŸ“º</span>
                                    <p style="margin: 0; font-weight: 600;">YouTube ì¸ë„¤ì¼ ë¡œë“œ ì‹¤íŒ¨</p>
                                </div>
                                <div class="youtube-play-large" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);">
                                    <div style="background: rgba(255,0,0,0.9); color: white; border-radius: 12px; padding: 1rem 1.5rem; font-size: 1.1rem; font-weight: 600; display: flex; align-items: center; gap: 0.8rem; box-shadow: 0 4px 20px rgba(0,0,0,0.4); transition: all 0.3s ease;">
                                        <span style="font-size: 1.5rem;">â–¶ï¸</span>
                                        <span>YouTubeì—ì„œ ì¬ìƒ</span>
                                    </div>
                                </div>
                            </div>
                        ` : `
                            <iframe width="100%" height="100%" src="${mediaItem.file_url}" frameborder="0" allowfullscreen 
                                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"></iframe>
                        `}
                    </div>
                `;
            } else if (isVimeo) {
                return `
                    <div style="position: relative; width: 100%; max-width: 800px; height: 450px; margin: 0 auto; border-radius: 8px; overflow: hidden;">
                        <iframe width="100%" height="100%" src="${mediaItem.file_url}" frameborder="0" allowfullscreen></iframe>
                    </div>
                `;
            } else if (isVideo) {
                const videoUrl = getSecureMediaUrl(mediaItem);
                return `
                    <div style="position: relative; width: 100%; max-width: 800px; margin: 0 auto; border-radius: 8px; overflow: hidden;">
                        ${videoUrl ? `
                            <video controls style="width: 100%; max-height: 450px; border-radius: 8px;" preload="metadata">
                                <source src="${videoUrl}" type="${mediaItem.mime_type}">
                                ë™ì˜ìƒì„ ì¬ìƒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
                            </video>
                        ` : `
                            <div style="width: 100%; height: 450px; background: linear-gradient(135deg, #667eea, #764ba2); display: flex; align-items: center; justify-content: center; flex-direction: column; color: white; border-radius: 8px;">
                                <span style="font-size: 4rem; margin-bottom: 1rem;">ğŸ¥</span>
                                <p style="margin: 0; font-weight: 600; text-align: center;">${mediaItem.title}</p>
                                <p style="margin: 0.5rem 0 0 0; opacity: 0.8;">ë™ì˜ìƒì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</p>
                            </div>
                        `}
                    </div>
                `;
            } else {
                const imageUrl = getSecureMediaUrl(mediaItem);
                return `
                    <div style="position: relative; width: 100%; max-width: 800px; margin: 0 auto; border-radius: 8px; overflow: hidden; background: #f8f9fa;">
                        ${imageUrl && !mediaItem.is_placeholder ? `
                            <img src="${imageUrl}" alt="${mediaItem.title}" 
                                 style="width: 100%; max-height: 450px; object-fit: contain; border-radius: 8px;"
                                 onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                        ` : ''}
                        <div class="image-error" style="${imageUrl && !mediaItem.is_placeholder ? 'display: none;' : 'display: flex;'} width: 100%; height: 450px; background: linear-gradient(135deg, #f8f9fa, #e9ecef); align-items: center; justify-content: center; flex-direction: column; color: #666; border-radius: 8px;">
                            <span style="font-size: 4rem; margin-bottom: 1rem;">${getCategoryIcon(mediaItem.category_code)}</span>
                            <p style="margin: 0; font-weight: 600; font-size: 1.1rem; text-align: center;">${mediaItem.title}</p>
                            <p style="margin: 0.5rem 0 0 0; font-size: 0.9rem; opacity: 0.7;">ì´ë¯¸ì§€ë¥¼ í‘œì‹œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤</p>
                            ${mediaItem.file_name ? `<p style="margin: 0.3rem 0 0 0; font-size: 0.8rem; opacity: 0.6;">íŒŒì¼: ${mediaItem.file_name}</p>` : ''}
                        </div>
                    </div>
                `;
            }
        }

        // YouTube ì¸ë„¤ì¼ì„ í”Œë ˆì´ì–´ë¡œ êµì²´
        function replaceWithYouTubePlayer(embedUrl, youtubeId) {
            const container = document.getElementById('youtubeContainer');
            if (container) {
                const finalEmbedUrl = embedUrl || `https://www.youtube.com/embed/${youtubeId}`;
                container.innerHTML = `
                    <iframe width="100%" height="100%" 
                           src="${finalEmbedUrl}?autoplay=1" 
                           frameborder="0" allowfullscreen
                           allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture">
                    </iframe>
                `;
            }
        }

        // ëª¨ë‹¬ ë‹«ê¸° í•¨ìˆ˜
        function closeMediaModal(event) {
            if (event && event.target !== event.currentTarget) return;
            
            const modal = document.getElementById('mediaDetailModal');
            if (modal) {
                modal.style.opacity = '0';
                setTimeout(() => {
                    modal.remove();
                }, 300);
            }
        }

        // ì—ëŸ¬ ëª¨ë‹¬ í‘œì‹œ í•¨ìˆ˜
        function showErrorModal(message) {
            const errorModal = `
                <div class="error-modal" style="
                    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                    background: rgba(0,0,0,0.5); display: flex; justify-content: center; align-items: center;
                    z-index: 10000;
                " onclick="this.remove()">
                    <div style="background: white; padding: 2rem; border-radius: 10px; text-align: center; max-width: 400px; margin: 1rem;" onclick="event.stopPropagation()">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">âš ï¸</div>
                        <p style="margin: 0; color: #666;">${message}</p>
                        <button onclick="this.closest('.error-modal').remove()" style="margin-top: 1rem; padding: 0.5rem 1rem; background: #667eea; color: white; border: none; border-radius: 5px; cursor: pointer;">í™•ì¸</button>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', errorModal);
        }

        // ë¯¸ë””ì–´ ì¢‹ì•„ìš” í•¨ìˆ˜
        function likeMedia(mediaId) {
            const currentUser = JSON.parse(localStorage.getItem('currentUser') || '{}');
            if (!currentUser.id) {
                alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                return;
            }

            fetch(`/api/media/items/${mediaId}/like`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    user_id: currentUser.id
                })
            })
            .then(response => response.json())
            .then(data => {
                showSuccessNotification(data.message);
                // ì¢‹ì•„ìš” ìˆ˜ ì—…ë°ì´íŠ¸
                updateLikeCount(mediaId, data.liked);
            })
            .catch(error => {
                console.error('ì¢‹ì•„ìš” ì²˜ë¦¬ ì‹¤íŒ¨:', error);
                showErrorNotification('ì¢‹ì•„ìš” ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            });
        }

        // ì¢‹ì•„ìš” ìˆ˜ ì—…ë°ì´íŠ¸
        function updateLikeCount(mediaId, isLiked) {
            // ëª¨ë“  í•´ë‹¹ ë¯¸ë””ì–´ ì•„ì´í…œì˜ ì¢‹ì•„ìš” ìˆ˜ ì—…ë°ì´íŠ¸
            const mediaItems = document.querySelectorAll(`[data-id="${mediaId}"]`);
            mediaItems.forEach(item => {
                const likeSpan = item.querySelector('.media-stats span:nth-child(2)');
                if (likeSpan) {
                    const currentCount = parseInt(likeSpan.textContent.replace(/[^\d]/g, '')) || 0;
                    const newCount = isLiked ? currentCount + 1 : Math.max(0, currentCount - 1);
                    likeSpan.textContent = `â¤ï¸ ${newCount}`;
                }
            });
        }

        // ë¯¸ë””ì–´ ë‹¤ìš´ë¡œë“œ í•¨ìˆ˜
        function downloadMedia(mediaId) {
            const currentUser = JSON.parse(localStorage.getItem('currentUser') || '{}');
            
            const downloadUrl = `/api/media/download/${mediaId}${currentUser.id ? `?user_id=${currentUser.id}` : ''}`;
            
            // ìƒˆ ì°½ì—ì„œ ë‹¤ìš´ë¡œë“œ ì‹œì‘
            window.open(downloadUrl, '_blank');
            showSuccessNotification('ë‹¤ìš´ë¡œë“œê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }

        // ì›ë³¸ ë¹„ë””ì˜¤ ì—´ê¸° í•¨ìˆ˜
        function openOriginalVideo(originalUrl) {
            if (originalUrl) {
                window.open(originalUrl, '_blank');
            } else {
                alert('ì›ë³¸ ë§í¬ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            }
        }

        // ë¯¸ë””ì–´ ê³µìœ  í•¨ìˆ˜
        function shareMedia(mediaId) {
            const shareUrl = `${window.location.origin}/media.html?item=${mediaId}`;
            
            if (navigator.share) {
                navigator.share({
                    title: 'ê²Œì„ ë¯¸ë””ì–´',
                    url: shareUrl
                }).catch(console.error);
            } else {
                navigator.clipboard.writeText(shareUrl).then(() => {
                    showSuccessNotification('ë§í¬ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
                }).catch(() => {
                    prompt('ë‹¤ìŒ ë§í¬ë¥¼ ë³µì‚¬í•˜ì„¸ìš”:', shareUrl);
                });
            }
        }

        // ì„±ê³µ ì•Œë¦¼ í‘œì‹œ
        function showSuccessNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed; top: 20px; right: 20px; z-index: 10000;
                background: #28a745; color: white; padding: 1rem 1.5rem;
                border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                animation: slideInRight 0.3s ease;
            `;
            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: 0.5rem;">
                    <span>âœ…</span>
                    <span>${message}</span>
                </div>
            `;
            document.body.appendChild(notification);
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 2700);
        }

        // ì—ëŸ¬ ì•Œë¦¼ í‘œì‹œ
        function showErrorNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed; top: 20px; right: 20px; z-index: 10000;
                background: #dc3545; color: white; padding: 1rem 1.5rem;
                border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                animation: slideInRight 0.3s ease;
            `;
            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: 0.5rem;">
                    <span>âš ï¸</span>
                    <span>${message}</span>
                </div>
            `;
            document.body.appendChild(notification);
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 2700);
        }

        // CSS ë¡œë”© ì™„ë£Œ í›„ JavaScript ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            if (document.readyState === 'complete') {
                initializeMediaPage();
            } else {
                window.addEventListener('load', initializeMediaPage);
            }
        });

        // ESC í‚¤ë¡œ ëª¨ë‹¬ ë‹«ê¸°
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeMediaModal();
                
                const errorModal = document.querySelector('.error-modal');
                if (errorModal) {
                    errorModal.remove();
                }
            }
        });

        // ì¶”ê°€ CSS ìŠ¤íƒ€ì¼
        const additionalStyles = document.createElement('style');
        additionalStyles.textContent = `
            @keyframes fadeIn {
                from { opacity: 0; }
                to { opacity: 1; }
            }
            
            @keyframes slideUp {
                from { transform: translateY(30px); opacity: 0; }
                to { transform: translateY(0); opacity: 1; }
            }
            
            @keyframes slideInRight {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            
            @keyframes slideOutRight {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
            
            .youtube-thumbnail-wrapper:hover .youtube-play-large div {
                transform: scale(1.05);
                box-shadow: 0 6px 25px rgba(0,0,0,0.5);
            }
            
            .media-item:hover .play-indicator {
                opacity: 1 !important;
            }
            
            .modal-close:hover {
                background: rgba(0,0,0,0.1);
                color: #333;
            }
            
            .loading-spinner {
                width: 40px;
                height: 40px;
                border: 4px solid #f3f3f3;
                border-top: 4px solid #667eea;
                border-radius: 50%;
                animation: spin 1s linear infinite;
            }

            @keyframes spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
            }

            .media-item {
                transition: all 0.3s ease;
                position: relative;
                overflow: hidden;
            }

            .media-item::before {
                content: '';
                position: absolute;
                top: 0;
                left: -100%;
                width: 100%;
                height: 100%;
                background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
                transition: left 0.5s;
                z-index: 1;
                pointer-events: none;
            }

            .media-item:hover::before {
                left: 100%;
            }

            .media-header {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                padding: 4rem 0;
                text-align: center;
            }

            .media-tabs {
                display: flex;
                gap: 0.5rem;
                margin-bottom: 2rem;
                border-bottom: 2px solid #f0f0f0;
                overflow-x: auto;
            }

            .media-tab {
                padding: 1rem 1.5rem;
                background: none;
                border: none;
                cursor: pointer;
                font-weight: 600;
                color: #666;
                transition: all 0.3s ease;
                position: relative;
                white-space: nowrap;
                min-width: fit-content;
            }

            .media-tab.active {
                color: #667eea;
            }

            .media-tab.active::after {
                content: '';
                position: absolute;
                bottom: -2px;
                left: 0;
                right: 0;
                height: 2px;
                background: linear-gradient(45deg, #667eea, #764ba2);
            }

            .media-tab:hover {
                color: #667eea;
            }

            .media-section {
                display: none;
            }

            .media-section.active {
                display: block;
            }

            .media-section h3 {
                margin-bottom: 1.5rem;
                color: #333;
                font-size: 1.5rem;
            }

            .media-gallery {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                gap: 1.5rem;
                margin-top: 2rem;
            }

            .media-item {
                background: white;
                border-radius: 15px;
                overflow: hidden;
                box-shadow: 0 5px 20px rgba(0,0,0,0.1);
                transition: all 0.3s ease;
                cursor: pointer;
            }

            .media-item:hover {
                transform: translateY(-5px);
                box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            }

            .media-thumbnail {
                position: relative;
                height: 200px;
                overflow: hidden;
            }

            .media-info {
                padding: 1rem;
            }

            .media-title {
                margin: 0 0 0.5rem 0;
                font-size: 1.1rem;
                font-weight: 600;
                color: #333;
                line-height: 1.3;
                overflow: hidden;
                text-overflow: ellipsis;
                white-space: nowrap;
            }

            .media-description {
                margin: 0 0 0.75rem 0;
                color: #666;
                font-size: 0.9rem;
                line-height: 1.4;
                overflow: hidden;
                display: -webkit-box;
                -webkit-line-clamp: 2;
                -webkit-box-orient: vertical;
            }

            .media-meta {
                display: flex;
                justify-content: space-between;
                font-size: 0.8rem;
                color: #999;
                margin-bottom: 0.5rem;
            }

            .media-stats {
                display: flex;
                gap: 0.75rem;
                font-size: 0.8rem;
                color: #888;
            }

            .btn:hover {
                transform: translateY(-2px);
                box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            }

            .btn-primary:hover {
                background: linear-gradient(45deg, #5a6fd8, #6a42a0) !important;
            }

            .btn-secondary:hover {
                background: #5a6268 !important;
            }

            .btn-warning:hover {
                background: #e0a800 !important;
            }

            .btn-info:hover {
                background: #138496 !important;
            }

            /* ë°˜ì‘í˜• ë””ìì¸ */
            @media (max-width: 768px) {
                .media-action-bar {
                    flex-direction: column;
                    gap: 1rem;
                }
                
                .action-buttons {
                    width: 100%;
                    justify-content: center;
                    flex-wrap: wrap;
                }
                
                .view-options {
                    width: 100%;
                    justify-content: center;
                }

                .media-gallery {
                    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                    gap: 1rem;
                }

                .modal-content {
                    margin: 1rem;
                    max-width: calc(100vw - 2rem);
                }
                
                #youtubeContainer, .video-container {
                    height: 250px !important;
                }
            }

            @media (max-width: 480px) {
                .media-gallery {
                    grid-template-columns: 1fr;
                }

                .action-buttons {
                    flex-direction: column;
                    align-items: stretch;
                }

                .action-buttons button {
                    width: 100%;
                    margin-bottom: 0.5rem;
                }
                
                #youtubeContainer, .video-container {
                    height: 200px !important;
                }
            }
        `;

        if (document.head) {
            document.head.appendChild(additionalStyles);
        }
    </script>
</body>
</html>